
{
  "entities": {
    "Client": {
      "title": "Client",
      "description": "Represents a client company.",
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "description": "The name of the client company."
        },
        "logoUrl": {
          "type": ["string", "null"],
          "description": "URL for the client's logo."
        },
        "userIds": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "List of Firebase Auth user IDs associated with this client."
        }
      },
      "required": ["name"]
    },
    "User": {
        "title": "User",
        "description": "Maps a Firebase Auth user to a client and their product access.",
        "type": "object",
        "properties": {
            "clientId": {
                "type": "string",
                "description": "The ID of the client this user belongs to."
            },
            "products": {
                "type": "array",
                "items": {
                    "type": "string",
                    "enum": ["process_flow", "pulse_check"]
                },
                "description": "List of products this user has access to."
            },
            "isConsultant": {
                "type": "boolean",
                "description": "Defines if the user is a consultant with broader access."
            }
        },
        "required": ["clientId", "products", "isConsultant"]
    },
    "ActivityComment": {
      "title": "Activity Comment",
      "description": "A comment on an activity.",
      "type": "object",
      "properties": {
        "autor": {
          "type": "string",
          "description": "The author of the comment."
        },
        "texto": {
          "type": "string",
          "description": "The text content of the comment."
        },
        "data": {
          "type": "string",
          "format": "date-time",
          "description": "The timestamp when the comment was created."
        }
      },
      "required": ["autor", "texto", "data"]
    },
    "Activity": {
      "title": "Activity",
      "description": "Represents a task or activity for HR/DP departments.",
      "type": "object",
      "properties": {
        "nome": {
          "type": "string",
          "description": "The name of the activity."
        },
        "categoria": {
          "type": ["string", "null"],
          "enum": ["DP", "RH", "Compartilhado", null],
          "description": "The category the activity belongs to."
        },
        "justificativa": {
          "type": ["string", "null"],
          "description": "The justification for the activity."
        },
        "responsavel": {
          "type": ["string", "null"],
          "description": "The person or department responsible for the activity."
        },
        "recorrencia": {
          "type": ["string", "null"],
          "enum": ["Di√°ria", "Semanal", "Mensal", "Trimestral", "Anual", "Sob demanda", null],
          "description": "The recurrence frequency of the activity."
        },
        "status": {
          "type": "string",
          "enum": ["brainstorm", "aguardando_consenso", "aprovada"],
          "description": "The current status of the activity."
        },
        "comentarios": {
          "type": "array",
          "items": {
            "$ref": "#/entities/ActivityComment"
          },
          "description": "A list of comments on the activity."
        },
        "dataAprovacao": {
          "type": ["string", "null"],
          "format": "date-time",
          "description": "The approval date of the activity."
        },
        "ultimaExecucao": {
          "type": ["string", "null"],
          "format": "date-time",
          "description": "The last execution date of the activity."
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "The creation date of the activity."
        },
        "statusTransicao": {
            "type": "string",
            "enum": ["a_transferir", "em_transicao", "concluida"],
            "description": "The transition status of the activity."
        },
        "responsavelAnterior": {
            "type": ["string", "null"],
            "description": "The previous responsible person for the activity."
        },
        "dataInicioTransicao": {
            "type": ["string", "null"],
            "format": "date-time",
            "description": "The start date of the transition."
        },
        "dataConclusaoTransicao": {
            "type": ["string", "null"],
            "format": "date-time",
            "description": "The conclusion date of the transition."
        },
        "prazoTransicao": {
            "type": ["string", "null"],
            "format": "date-time",
            "description": "The deadline for the transition."
        },
        "historicoExecucoes": {
          "type": "array",
          "items": {
            "type": "string",
            "format": "date-time"
          },
          "description": "A history of the last execution dates of the activity."
        },
        "parentId": {
          "type": ["string", "null"],
          "description": "The ID of the parent activity, if this is a sub-task."
        }
      },
      "required": ["nome", "status", "createdAt", "statusTransicao"]
    },
    "ConsultancyAction": {
      "title": "Consultancy Action",
      "description": "Represents an action item defined by the consultancy.",
      "type": "object",
      "properties": {
        "acao": {
          "type": "string",
          "description": "The name or title of the action."
        },
        "como_sera_realizada": {
          "type": "string",
          "description": "Description of how the action will be carried out."
        },
        "responsavel": {
          "type": "string",
          "description": "The person or department responsible for the action."
        },
        "data_inicio": {
          "type": "string",
          "format": "date-time",
          "description": "The start date of the action."
        },
        "data_termino": {
          "type": "string",
          "format": "date-time",
          "description": "The planned end date of the action."
        },
        "prazo_realizado": {
          "type": ["string", "null"],
          "format": "date-time",
          "description": "The actual completion date of the action."
        },
        "percentual_concluido": {
          "type": "number",
          "description": "The actual percentage of completion."
        },
        "percentual_planejado": {
          "type": "number",
          "description": "The planned percentage of completion for the current date."
        },
        "status": {
          "type": "string",
          "enum": ["nao_iniciada", "em_andamento", "concluida", "atrasada", "cancelada"],
          "description": "The current status of the action."
        },
        "observacoes": {
          "type": "string",
          "description": "General observations or notes."
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "The creation date of the action."
        }
      },
      "required": ["acao", "responsavel", "data_inicio", "data_termino", "percentual_concluido", "percentual_planejado", "status", "createdAt"]
    },
    "Question": {
        "title": "Question",
        "description": "A single question that can be used in a survey.",
        "type": "object",
        "properties": {
            "text": { "type": "string", "description": "The question text." },
            "type": { "type": "string", "enum": ["nps", "likert", "multiple-choice", "open-text"] },
            "category": { "type": "string", "description": "Category of the question (e.g., Leadership)." },
            "options": { "type": "array", "items": { "type": "string" }, "description": "Answer choices for multiple-choice questions." }
        },
        "required": ["text", "type"]
    },
    "Survey": {
        "title": "Survey",
        "description": "A specific, active survey sent to employees.",
        "type": "object",
        "properties": {
            "title": { "type": "string", "description": "The title of the survey." },
            "description": { "type": "string", "description": "A brief description of the survey." },
            "clientId": { "type": "string", "description": "The client this survey belongs to." },
            "status": { "type": "string", "enum": ["draft", "active", "closed"], "description": "The current status of the survey." },
            "questions": { "type": "array", "items": { "$ref": "#/entities/Question" }, "description": "A list of questions included in the survey." },
            "isAnonymous": { "type": "boolean", "description": "Whether the survey responses are anonymous." },
            "createdAt": { "type": "string", "format": "date-time" },
            "opensAt": { "type": "string", "format": "date-time", "description": "When the survey becomes available for responses." },
            "closesAt": { "type": "string", "format": "date-time", "description": "When the survey closes for responses." }
        },
        "required": ["title", "clientId", "status", "questions", "isAnonymous", "createdAt", "opensAt", "closesAt"]
    },
    "Response": {
        "title": "Response",
        "description": "An employee's response to a survey.",
        "type": "object",
        "properties": {
            "surveyId": { "type": "string" },
            "clientId": { "type": "string" },
            "respondentId": { "type": ["string", "null"], "description": "The user's UID if not anonymous." },
            "answers": { 
                "type": "object", 
                "additionalProperties": {
                    "type": "object",
                    "properties": {
                       "questionText": {"type": "string"},
                       "answer": {"type": ["string", "number"]}
                    },
                    "required": ["questionText", "answer"]
                },
                "description": "An object where keys are question IDs and values are the answers."
            },
            "submittedAt": { "type": "string", "format": "date-time" }
        },
        "required": ["surveyId", "clientId", "answers", "submittedAt"]
    }
  },
  "auth": {
    "providers": ["password"]
  },
  "firestore": {
    "/clients/{clientId}": {
        "schema": { "$ref": "#/entities/Client" },
        "description": "Stores information about each client company.",
        "subcollections": {
            "activities": {
                "path": "/clients/{clientId}/activities/{activityId}",
                "schema": { "$ref": "#/entities/Activity" },
                "description": "Stores all activities for a specific client (ProcessFlow product)."
            },
            "actions": {
                "path": "/clients/{clientId}/actions/{actionId}",
                "schema": { "$ref": "#/entities/ConsultancyAction" },
                "description": "Stores all consultancy action items for a specific client (ProcessFlow product)."
            },
            "surveys": {
                "path": "/clients/{clientId}/surveys/{surveyId}",
                "schema": { "$ref": "#/entities/Survey" },
                "description": "Stores all surveys for a specific client (PulseCheck product)."
            }
        }
    },
    "/users/{userId}": {
        "schema": { "$ref": "#/entities/User" },
        "description": "Maps Firebase Auth UIDs to client IDs and product access."
    },
    "/pulse_check_questions/{questionId}": {
        "schema": { "$ref": "#/entities/Question" },
        "description": "Global repository of questions for PulseCheck, managed by consultants."
    },
    "/pulse_check_responses/{responseId}": {
        "schema": { "$ref": "#/entities/Response" },
        "description": "Collection for all anonymous and identified survey responses."
    }
  }
}
